<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tablero de Productividad Avanzado</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f0f2f5;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    
    /* --- Estilos del menú de navegación --- */
    .header-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid #ccc;
      margin-bottom: 20px;
    }
    .header-nav .view-tabs {
      display: flex;
      gap: 10px;
    }
    .header-nav .view-tabs button {
      padding: 8px 15px;
      border: none;
      background: #e0e0e0;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.2s ease;
    }
    .header-nav .view-tabs button.active {
      background: #007bff;
      color: #fff;
    }

    /* --- Estilos del Tablero (Kanban) --- */
    .board-view {
      display: flex;
      gap: 20px;
      justify-content: center;
    }
    .column {
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      width: 320px;
      min-height: 500px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      transition: box-shadow 0.3s ease;
      position: relative;
    }
    .column h2 {
      text-align: center;
      margin-bottom: 15px;
    }
    .task {
      background: #ffffff;
      margin: 12px 0;
      padding: 12px;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      transition: transform 0.2s ease, border-left 0.3s ease;
      cursor: grab;
      border-left: 5px solid transparent;
      position: relative;
    }
    .task[data-priority="Alta"] { border-left-color: #e74c3c; }
    .task[data-priority="Media"] { border-left-color: #f1c40f; }
    .task[data-priority="Baja"] { border-left-color: #2ecc71; }
    .task h3 {
      margin: 0 0 6px;
      font-size: 1.1em;
    }
    .add-task-btn {
      width: 100%;
      padding: 10px;
      margin-top: 15px;
      border: 2px dashed #bdc3c7;
      background: #fdfdfd;
      border-radius: 8px;
      cursor: pointer;
      color: #7f8c8d;
    }

    /* --- Estilos de la Vista de Lista --- */
    .list-view {
      display: none; /* Oculta por defecto */
      max-width: 900px;
      margin: 0 auto;
      background: #fff;
      border-radius: 10px;
      padding: 20px;
    }
    .list-header {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
      padding: 10px 0;
      font-weight: bold;
      border-bottom: 2px solid #ccc;
    }
    .list-group {
      margin-top: 20px;
    }
    .list-group-header {
      font-size: 1.2em;
      font-weight: bold;
      padding: 10px 0;
      cursor: pointer;
    }
    .list-task {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid #eee;
    }
    .list-task span, .list-task div {
      padding-right: 10px;
    }
    .list-task .task-title {
      display: flex;
      align-items: center;
    }
    .list-task .task-title input[type="checkbox"] {
      margin-right: 10px;
    }
    .priority-badge {
      padding: 4px 8px;
      border-radius: 5px;
      color: #fff;
      font-size: 0.8em;
    }
    .priority-badge.alta { background: #e74c3c; }
    .priority-badge.media { background: #f1c40f; }
    .priority-badge.baja { background: #2ecc71; }
  </style>
</head>
<body>
  <div class="header-nav">
    <div class="view-tabs">
      <button id="tablero-btn" class="active" onclick="setView('kanban')">Tablero</button>
      <button id="lista-btn" onclick="setView('list')">Lista</button>
      <button onclick="alert('Funcionalidad de Calendario en desarrollo')">Calendario</button>
    </div>
    <button onclick="alert('Añadir tarea')">+ Agregar tarea</button>
  </div>

  <div id="kanban-container" class="board-view">
    <div class="column" data-status="por-hacer" ondrop="drop(event)" ondragover="allowDrop(event)">
      <h2>Por hacer</h2>
      <button class="add-task-btn" onclick="addTask('por-hacer')">+ Agregar tarea</button>
    </div>
    <div class="column" data-status="en-progreso" ondrop="drop(event)" ondragover="allowDrop(event)">
      <h2>En progreso</h2>
      <button class="add-task-btn" onclick="addTask('en-progreso')">+ Agregar tarea</button>
    </div>
    <div class="column" data-status="hecho" ondrop="drop(event)" ondragover="allowDrop(event)">
      <h2>Hecho</h2>
      <button class="add-task-btn" onclick="addTask('hecho')">+ Agregar tarea</button>
    </div>
  </div>

  <div id="list-container" class="list-view">
    <div class="list-header">
      <span>Nombre</span>
      <span>Fecha de vencimiento</span>
      <span>Colaboradores</span>
      <span>Prioridad</span>
      <span>Etiquetas</span>
    </div>
    </div>

  <script>
    // --- Modelo de Datos (Igual que antes) ---
    let tasks = [
      { id: 'task-1', title: 'Diseñar UI', status: 'por-hacer', priority: 'Alta', assignee: 'Victor', dueDate: '2025-08-30', subtasks: [{ name: 'Wireframes', completed: false }] },
      { id: 'task-2', title: 'Definir MVP', status: 'por-hacer', priority: 'Media', assignee: 'Victor', dueDate: '2025-09-05', subtasks: [] },
      { id: 'task-3', title: 'Implementar login', status: 'en-progreso', priority: 'Alta', assignee: 'Ana', dueDate: '2025-08-25', subtasks: [] },
      { id: 'task-4', title: 'Reunión de seguimiento', status: 'por-hacer', priority: 'Alta', assignee: 'Equipo', dueDate: '2025-08-15', subtasks: [] },
      { id: 'task-5', title: 'Documentación técnica', status: 'hecho', priority: 'Baja', assignee: 'Luis', dueDate: '2025-08-10', subtasks: [] }
    ];

    // --- Lógica de Vistas y Renderizado ---
    const kanbanContainer = document.getElementById('kanban-container');
    const listContainer = document.getElementById('list-container');
    const kanbanBtn = document.getElementById('tablero-btn');
    const listBtn = document.getElementById('lista-btn');

    function setView(view) {
      if (view === 'kanban') {
        kanbanContainer.style.display = 'flex';
        listContainer.style.display = 'none';
        kanbanBtn.classList.add('active');
        listBtn.classList.remove('active');
        renderKanban();
      } else if (view === 'list') {
        kanbanContainer.style.display = 'none';
        listContainer.style.display = 'block';
        kanbanBtn.classList.remove('active');
        listBtn.classList.add('active');
        renderList();
      }
    }

    function renderKanban() {
      // Limpiar columnas existentes
      document.querySelectorAll('.column > .task').forEach(taskEl => taskEl.remove());

      tasks.forEach(task => {
        const taskEl = document.createElement('div');
        taskEl.className = 'task';
        taskEl.id = task.id;
        taskEl.setAttribute('draggable', 'true');
        taskEl.setAttribute('data-priority', task.priority);

        // Contenido del tablero (similar a la propuesta anterior)
        taskEl.innerHTML = `
          <div class="task-content">
            <h3 contenteditable="true" onblur="updateTaskTitle(this, '${task.id}')">${task.title}</h3>
            </div>
          <div class="task-meta">
            <div class="priority-label">${task.priority}</div>
            <div class="assignee-label">Responsable: ${task.assignee}</div>
            <div class="due-date">Vence: ${task.dueDate}</div>
          </div>
        `;
        taskEl.addEventListener('dragstart', drag);

        const targetColumn = kanbanContainer.querySelector(`.column[data-status="${task.status}"]`);
        if (targetColumn) {
          const addTaskBtn = targetColumn.querySelector('.add-task-btn');
          targetColumn.insertBefore(taskEl, addTaskBtn);
        }
      });
    }

    function renderList() {
      // Limpiar la vista de lista
      listContainer.querySelectorAll('.list-group').forEach(group => group.remove());

      // Agrupar tareas por estado
      const groups = tasks.reduce((acc, task) => {
        (acc[task.status] = acc[task.status] || []).push(task);
        return acc;
      }, {});
      
      const statusMap = {
        'por-hacer': 'Por hacer',
        'en-progreso': 'En progreso',
        'hecho': 'Hecho'
      };

      for (const status in groups) {
        const groupEl = document.createElement('div');
        groupEl.className = 'list-group';
        
        groupEl.innerHTML = `<div class="list-group-header">${statusMap[status]} (${groups[status].length})</div>`;

        groups[status].forEach(task => {
          const taskEl = document.createElement('div');
          taskEl.className = 'list-task';
          taskEl.innerHTML = `
            <div class="task-title">
              <input type="checkbox" ${task.status === 'hecho' ? 'checked' : ''} onclick="updateTaskStatus(this, '${task.id}')"/>
              <span>${task.title}</span>
            </div>
            <span>${task.dueDate}</span>
            <span>${task.assignee}</span>
            <div><span class="priority-badge ${task.priority.toLowerCase()}">${task.priority}</span></div>
            <span>-</span> `;
          groupEl.appendChild(taskEl);
        });
        listContainer.appendChild(groupEl);
      }
    }

    // --- Funciones de Lógica (modificadas) ---
    function addTask(status) {
      const newTask = {
        id: `task-${Date.now()}`,
        title: 'Nueva tarea',
        status: status,
        priority: 'Media',
        assignee: 'Sin asignar',
        dueDate: 'YYYY-MM-DD',
        subtasks: []
      };
      tasks.push(newTask);
      renderKanban();
    }
    
    function updateTaskTitle(element, taskId) {
      const task = tasks.find(t => t.id === taskId);
      if (task) { task.title = element.innerText; }
    }

    function updateTaskStatus(checkbox, taskId) {
      const task = tasks.find(t => t.id === taskId);
      if (task) {
        task.status = checkbox.checked ? 'hecho' : 'por-hacer';
        // Volvemos a renderizar la vista actual para que se actualice
        setView(listContainer.style.display === 'block' ? 'list' : 'kanban');
      }
    }

    // --- Funciones de Drag and Drop (igual que antes) ---
    function allowDrop(ev) { ev.preventDefault(); }
    function drag(ev) { ev.dataTransfer.setData("text/plain", ev.target.id); }

    function drop(ev) {
      ev.preventDefault();
      const data = ev.dataTransfer.getData("text/plain");
      const taskElement = document.getElementById(data);
      const targetColumn = ev.target.closest('.column');
      if (targetColumn) {
        const task = tasks.find(t => t.id === data);
        if (task) { task.status = targetColumn.dataset.status; }
        const addTaskBtn = targetColumn.querySelector('.add-task-btn');
        targetColumn.insertBefore(taskElement, addTaskBtn);
      }
    }

    // Inicializar el tablero al cargar la página
    document.addEventListener('DOMContentLoaded', () => {
      setView('kanban'); // Inicia con la vista de tablero por defecto
    });
  </script>
</body>
</html>